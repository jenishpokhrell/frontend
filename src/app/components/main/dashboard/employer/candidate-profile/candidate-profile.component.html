<div class="flex flex-col md:flex-row h-screen bg-gray-100 dark:bg-gray-900">
  <!-- Mobile Sidebar Overlay -->
  <div *ngIf="mobileSidebarVisible" class="fixed inset-0 z-40 bg-gray-600 bg-opacity-75 md:hidden" (click)="toggleMobileSidebar()"></div>

  <!-- Sidebar -->
  <app-sidebar
    [menuItems]="menuItems"
    [collapsed]="collapsed"
    (toggleCollapse)="toggleSidebar()"
    class="hidden md:block"
  ></app-sidebar>

  <!-- Mobile Sidebar -->
  <div *ngIf="mobileSidebarVisible" class="fixed inset-y-0 left-0 z-50 w-64 bg-gray-800 md:hidden">
    <app-sidebar
      [menuItems]="menuItems"
      [collapsed]="false"
      (toggleCollapse)="toggleMobileSidebar()"
    ></app-sidebar>
  </div>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col overflow-hidden"
    [class.md:ml-14]="!collapsed"
    [class.md:ml-5]="collapsed">
    
    <!-- Header -->
    <app-header
      [title]="'Candidate Profile'"
      (toggleSidebar)="toggleMobileSidebar()"
    ></app-header>

    <main class="flex-1 overflow-y-auto p-4 sm:p-6 bg-gray-50 dark:bg-gray-800">
      <router-outlet></router-outlet>
      <!-- Personal Information Section -->
      <div class="w-full">
        <div>
          <h2 class="text-lg font-semibold text-gray-800 dark:text-white">
            Personal Information
          </h2>
        </div>
        
        <!-- Profile and Contact Info -->
        <div class="mt-4 sm:mt-7 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
          <!-- Profile Photo -->
          <div class="flex justify-center md:justify-start w-full md:w-auto">
            @if(candidate?.profilePhoto === null){
              <div class="bg-blue-900 text-white w-40 h-40 sm:w-28 sm:h-28 text-xl sm:text-2xl font-bold rounded-full flex items-center justify-center">
                {{ candidate?.firstname?.charAt(0) }}
              </div>
            }@else{
              <div class="w-40 h-40 rounded-full overflow-hidden">
                <img
                  [src]="candidate?.profilePhoto"
                  alt="profile picture"
                  class="w-full h-full object-cover"
                />
              </div>
            }
          </div>
          
          <!-- Contact Information -->
          <div class="bg-gray-900 p-4 sm:p-6 md:p-8 w-full md:w-[35%] shadow-lg">
            <div class="mb-3 sm:mb-5">
              <h2 class="text-lg font-semibold text-white">
                Contact Information
              </h2>
            </div>
            <hr class="mb-3 sm:mb-5 border-gray-700">
            <div class="text-gray-50 space-y-2 sm:space-y-3 text-sm sm:text-[14px]">
              <p class="flex items-center">
                <span class="mr-3 sm:mr-4 w-5"><fa-icon [icon]="location"></fa-icon></span>
                {{ candidate?.address }}
              </p>
              <p class="flex items-center">
                <span class="mr-3 sm:mr-4 w-5"><fa-icon [icon]="mail"></fa-icon></span>
                {{ candidate?.email }}
              </p>
              <p class="flex items-center">
                <span class="mr-3 sm:mr-4 w-5"><fa-icon [icon]="contact"></fa-icon></span>
                {{ candidate?.contact }}
              </p>
            </div>
          </div>
        </div>

        <!-- Basic Information -->
        <div *ngIf="candidate" class="flex flex-col md:flex-row w-full gap-4 sm:gap-6 mt-4 sm:mt-6 text-sm sm:text-[14px]">
          <!-- Left Column -->
          <div class="w-full md:w-1/2 p-2 sm:p-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mt-4 sm:mt-6 text-gray-50">
              <div class="space-y-1">
                <p class="font-bold">Firstname</p>
                <p class="bg-gray-600 py-2 px-3 sm:px-4 rounded-full">
                  {{ candidate.firstname }}
                </p>
              </div>
              <div class="space-y-1">
                <p class="font-bold dark:text-gray-300">Lastname</p>
                <p class="bg-gray-600 py-2 px-3 sm:px-4 rounded-full">
                  {{ candidate.lastname }}
                </p>
              </div>
              <div class="space-y-1">
                <p class="font-bold dark:text-gray-300">Username</p>
                <p class="bg-gray-600 py-2 px-3 sm:px-4 rounded-full">
                  {{ candidate.username }}
                </p>
              </div>
              <div class="space-y-1">
                <p class="font-bold dark:text-gray-300">Gender</p>
                <p class="bg-gray-600 py-2 px-3 sm:px-4 rounded-full">
                  {{ candidate.gender}}
                </p>
              </div>
              <div class="space-y-1">
                <p class="font-bold dark:text-gray-300">Position</p>
                <p class="bg-gray-600 py-2 px-3 sm:px-4 rounded-full">
                  {{ candidate.jobTitle  }}
                </p>
              </div>
              <div class="space-y-1">
                <p class="font-bold dark:text-gray-300">YOE</p>
                <p class="bg-gray-600 py-2 px-3 sm:px-4 rounded-full">
                  {{ candidate.years_Of_Experience  }} years
                </p>
              </div>
            </div>
          </div>

          <!-- Right Column (Skills & Resume) -->
          <div class="w-full md:w-1/2 p-2 sm:p-4 shadow-lg bg-gray-900 rounded-lg">
            <div class="mb-3 sm:mb-5">
              <h2 class="text-lg font-semibold text-white">
                Skills
              </h2>
            </div>
            <hr class="mb-3 sm:mb-5 border-gray-700">
            
            <div class="flex flex-wrap gap-2">
              <div *ngFor="let skill of skills" class="bg-gray-700 px-3 py-2 rounded-full">
                <p class="text-gray-50 text-sm">{{ skill.skill }}</p>
              </div>
              <div *ngIf="skills.length === 0" class="text-gray-300 text-sm italic">
                No skills listed
              </div>
            </div>
            
            <hr class="my-4 sm:my-6 border-gray-700">
            
            <div class="mb-3 sm:mb-5">
              <h2 class="text-lg font-semibold text-white">
                Candidate Resume
              </h2>
            </div>
            
            <div *ngIf="resume" class="flex items-center gap-3">
              <a [href]="resume.candidateResume" target="_blank" class="hover:opacity-80 transition-opacity">
                <img src="./assets/pdf.png" alt="resume" class="w-12 h-12 sm:w-16 sm:h-16">
              </a>
              <span class="text-gray-300 text-sm">Click to view resume</span>
            </div>
            
            <div *ngIf="!resume">
              <p class="text-gray-300 text-sm italic">
                **NOTE: Candidate hasn't added their resume yet.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Work Experience & Projects -->
      <div class="mt-6 sm:mt-8">
        <div class="flex flex-col lg:flex-row gap-6 sm:gap-8">
          <!-- Work Experience -->
          <div class="w-full lg:w-1/2">
            <div>
              <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-2 sm:mb-4">
                Work Experience
              </h2>
              <hr class="border-gray-300 dark:border-gray-600">
            </div>
            
            <div *ngIf="experiences.length === 0" class="mt-6 text-center">
              <p class="text-gray-500 dark:text-gray-400 italic">No experiences to show.</p>
            </div>
            
            <div *ngFor="let experience of experiences" class="text-gray-50 mt-4 sm:mt-6 bg-gray-900 p-4 sm:p-6 shadow-lg rounded-lg">
              <div class="mb-2">
                <h2 class="text-lg font-semibold text-white">
                  {{ experience.jobTitle }}
                </h2>
                <p class="text-gray-300 text-sm">
                  {{ experience.companyName }}
                </p>
              </div>
              
              @if(experience.to !== null){
                <p class="text-gray-400 text-xs sm:text-sm mb-3">
                  {{ experience.from}} - {{ experience.to }}
                </p>
              }@else {
                <p class="text-gray-400 text-xs sm:text-sm mb-3">
                  {{ experience.from }} - <span class="italic">Present</span>
                </p>
              }
              
              <div class="text-gray-300 text-sm">
                <p>{{ experience.jobDescription }}</p>
              </div>
            </div>
          </div>
          
          <!-- Projects -->
          <div class="w-full lg:w-1/2">
            <div>
              <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-2 sm:mb-4">
                Projects
              </h2>
              <hr class="border-gray-300 dark:border-gray-600">
            </div>
            
            <div *ngIf="projects.length === 0" class="mt-6 text-center">
              <p class="text-gray-500 dark:text-gray-400 italic">No projects to show.</p>
            </div>
            
            <div *ngFor="let project of projects" class="text-gray-50 mt-4 sm:mt-6 bg-gray-900 p-4 sm:p-6 shadow-lg rounded-lg">
              <div class="mb-2">
                <h2 class="text-lg font-semibold text-white">
                  {{ project.projectName }}
                </h2>
              </div>
              
              <div class="mb-3">
                <p class="text-sm">
                  <span class="font-semibold text-gray-300">Project URL: </span>
                  @if(project.projectURL){
                    <a [href]="project.projectURL" target="_blank" class="text-blue-400 hover:underline break-all">
                      {{ project.projectURL }}
                    </a>
                  }@else {
                    <span class="text-gray-400 italic">Not specified</span>
                  }
                </p>
              </div>
              
              <div class="text-gray-300 text-sm">
                <p>{{ project.projectDescription }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Academic Experience -->
      <div class="mt-6 sm:mt-8">
        <div>
          <h2 class="text-lg font-semibold text-white mb-2 sm:mb-4">Academic experience</h2>
          <hr class="border-gray-300 dark:border-gray-600">
        </div>
        
        <div *ngIf="academic" class="w-full lg:w-2/3 sm:p-4">
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mt-4 sm:mt-6 text-gray-50">
            <div class="space-y-1">
              <p class="font-bold ">Institution Name</p>
              <p class="bg-gray-700 py-2 px-3 sm:px-4 rounded-full text-sm sm:text-[15px]">
                {{ academic.institutionName  }}
              </p>
            </div>
            <div class="space-y-1">
              <p class="font-bold">Stream</p>
              <p class="bg-gray-700 py-2 px-3 sm:px-4 rounded-full text-sm sm:text-[15px]">
                {{ academic.stream }}
              </p>
            </div>
            <div class="space-y-1">
              <p class="font-bold">Start Year</p>
              <p class="bg-gray-700 py-2 px-3 sm:px-4 rounded-full text-sm sm:text-[15px]">
                {{ academic.startYear  }}
              </p>
            </div>
            <div class="space-y-1">
              <p class="font-bold">End Year</p>
              <p class="bg-gray-700 py-2 px-3 sm:px-4 rounded-full text-sm sm:text-[15px]">
                {{ academic.graduationYear  }}
              </p>
            </div>
            <div class="space-y-1">
              <p class="font-bold">Degree Type</p>
              <p class="bg-gray-700 py-2 px-3 sm:px-4 rounded-full text-sm sm:text-[15px]">
                {{ academic.degreeType }}
              </p>
            </div>
            <div class="space-y-1">
              <p class="font-bold">Current Semester</p>
              <p class="bg-gray-700 py-2 px-3 sm:px-4 rounded-full text-sm sm:text-[15px]">
                {{ academic.currentSemester }}
              </p>
            </div>
          </div>
        </div>
        
        <div *ngIf="!academic" class="mt-6 text-center">
          <p class="text-gray-500 dark:text-gray-400 italic">No academic information available.</p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col sm:flex-row justify-center gap-4 sm:gap-6 mt-8 sm:mt-10">
        <button
          (click)="updateJobApplicationStatus(jobApplicationId, 'Shortlisted')"
          class="px-4 py-3 bg-blue-600 hover:bg-blue-700 rounded-full text-white text-sm sm:text-[13px] font-medium transition-colors"
        >
          Shortlist Candidate
        </button>
        <button
          (click)="updateJobApplicationStatus(jobApplicationId, 'Rejected')"
          class="px-4 py-3 bg-red-500 hover:bg-red-600 rounded-full text-white text-sm sm:text-[13px] font-medium transition-colors"
        >
          Reject Candidate
        </button>
      </div>
    </main>
  </div>
</div>