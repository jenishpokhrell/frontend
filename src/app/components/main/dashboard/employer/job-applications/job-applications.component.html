<div class="flex h-screen bg-gray-100 dark:bg-gray-900">
    <app-sidebar [menuItems]="menuItems" 
                 [collapsed]="collapsed"
                 (toggleCollapse)="toggleSidebar()"></app-sidebar>
  
    <div class="flex-1 flex flex-col overflow-hidden" [class.ml-14]="!collapsed" [class.ml-5]="collapsed">
      <app-header [title]="'Job Applications'"
                  (toggleSidebar)="toggleSidebar()"></app-header>
  
      <main class="flex-1 overflow-y-auto p-6 bg-gray-50 dark:bg-gray-800">
        <div class="w-full">
            <div *ngIf="job" class=" text-gray-50">
              <div
                
                class="flex items-center justify-between my-5"
              >
                <div class="">
                  <h1 class="text-3xl font-bold text-gray-50 uppercase">
                    {{ job.jobTitle }}
                  </h1>
                  <div class="flex space-x-10 font-extralight text-[14px]">
                    <p>{{ job.jobType }}</p>
                    <p>{{ job.no_of_Openings }} Vacancies</p>
                  </div>
                </div>
              </div>
          
              <hr />
          
              <div class="my-5 flex items-start justify-between space-x-20">
                <div class="my-5 w-[70%]">
                  <div class="bg-gray-900 rounded-xl px-10 py-5">
                    <div class="my-5">
                      <h2 class="text-2xl font-bold text-gray-50">Job Information</h2>
                    </div>
                    <hr />
                    <div>
                      <div class="flex justify-between mt-5">
                        <div class="space-y-5">
                          <p>
                            Job Type: <span>{{ job.jobType }}</span>
                          </p>
                          <p>
                            Job Level: <span>{{ job.jobLevel }}</span>
                          </p>
                          <p>
                            No. of openings: <span>{{ job.no_of_Openings }}</span>
                          </p>
                          <p>
                            Salary:
                            <span>Nrs. {{ job.minimumSalary }} to {{ job.maximumSalary }}</span>
                          </p>
                        </div>
                        <div class="space-y-5">
                          <p>
                            Experience required: {{ job.min_Years_of_Experience_Required }} to
                            {{ job.max_Years_of_Experience_Required }} years
                          </p>
                          <p>Location: Pulchowk, Lalitpur</p>
                          @if (job.isActive == true) {
                          <p>Status: <span class="text-green-600">Active</span></p>
                          }@else{
                          <p>Status: <span class="text-red-600">Closed </span></p>
                          }
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="my-10 bg-gray-900 rounded-xl px-10 py-5 space-y-4"
                  >
                    <h2 class="text-2xl font-bold text-gray-50">Description</h2>
                    <hr />
                    <p class="text-justify leading-8">{{ job.jobDescription }}</p>
                  </div>
                  <div
                    class="mt-10 bg-gray-900 rounded-xl px-10 py-5 space-y-4"
                  >
                    <h2 class="text-2xl font-bold text-gray-50">Requirements</h2>
                    <hr />
                    <p class="text-justify leading-8">{{ job.requirements }}</p>
                  </div>
                </div>
                <div class="my-5 mr-10 space-y-5">
                  <div>
                    <button class="p-4 bg-blue-900 rounded-full w-32 text-[12px] cursor-pointer" routerLink="/employer/edit-job/{{job.id}}">Edit Job</button>
                  </div>
                  <div>
                    <button class="p-4 bg-red-600 rounded-full w-32 text-[12px] cursor-pointer">Close Job</button>
                  </div>
                </div>
            </div>
            <div class="overflow-x-auto mb-10">
              <div> 
                <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-5 uppercase">Applications</h2>
              </div>
                <table
                  class="min-w-full divide-y divide-gray-200 dark:divide-gray-600"
                >
                  <thead class="bg-gray-50 dark:bg-gray-600">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Status
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Candidate username
                    </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        
                      </th>
                    </tr>
                  </thead>
                  <tbody
                  
                  class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600 cursor-pointer"
                  >
                  <tr
                  *ngFor="let job of job.jobApplications"
                      class="hover:bg-gray-50 dark:hover:bg-gray-600"
                    >
                      <td 
                        class="px-6 py-4 whitespace-nowrap text-[10px] font-medium text-gray-800 dark:text-white"
                      >
                      @if(job.jobStatus === 'Pending'){
                        <span class="bg-yellow-100 p-2 text-gray-900 rounded-full">{{job.jobStatus}}</span>
                      }@else if(job.jobStatus === 'Shortlisted'){
                        <span class="bg-green-200 p-2 text-gray-900 rounded-full">{{job.jobStatus}}</span>
                      }@else {
                        <span class="bg-red-200 p-2 text-gray-900 rounded-full">{{job.jobStatus}}</span>
                      }     
                      </td>
                      <td
                      class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-white"
                    >
                      {{ job.candidateName }}
                    </td>
                    <td
                      class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-300 space-x-4"
                    >
                      <button class="p-4 bg-blue-900 rounded-full w-fit text-[12px]" routerLink="/employer/candidate-profile/{{job.candidateId}}">View Profile</button>
                    </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div *ngIf="job.jobApplications.length === 0">
                <h2>No one has applied for the job yet.</h2>
              </div>
        </div>
        </div>
      </main>
    </div> 
  </div>